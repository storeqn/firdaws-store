<!doctype html>

<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙØ±Ø¯ÙˆØ³</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙØ±Ø¯ÙˆØ³">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #08080f;
      --bg2: #0e0e1a;
      --surface: rgba(255,255,255,0.04);
      --surface2: rgba(255,255,255,0.07);
      --border: rgba(255,255,255,0.08);
      --border2: rgba(255,255,255,0.14);
      --text: #f0f0ff;
      --muted: #8888aa;
      --accent: #7c6dfa;
      --accent2: #5b4ee8;
      --gold: #f5c842;
      --green: #2ecc71;
      --red: #e74c3c;
      --r: 18px;
      --r2: 26px;
      --safe-top: env(safe-area-inset-top);
      --safe-bottom: env(safe-area-inset-bottom);
      --safe-left: env(safe-area-inset-left);
      --safe-right: env(safe-area-inset-right);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'IBM Plex Sans Arabic', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: calc(90px + var(--safe-bottom));
      overflow-x: hidden;
    }

    /* â”€â”€ Background â”€â”€ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 900px 500px at 30% -10%, rgba(124,109,250,0.18), transparent 60%),
        radial-gradient(ellipse 600px 400px at 80% 80%, rgba(91,78,232,0.10), transparent 60%);
      pointer-events: none;
      z-index: 0;
    }

    /* â”€â”€ Header â”€â”€ */
    header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: rgba(8,8,15,0.82);
      backdrop-filter: blur(20px) saturate(160%);
      -webkit-backdrop-filter: blur(20px) saturate(160%);
      border-bottom: 1px solid var(--border);
      padding-top: calc(10px + var(--safe-top));
      padding-left: calc(12px + var(--safe-left));
      padding-right: calc(12px + var(--safe-right));
    }

    .bar {
      max-width: 1200px;
      margin: auto;
      padding: 8px 0 10px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 12px;
    }

    .brand {
      text-align: center;
    }
    .brand-name {
      font-size: 17px;
      font-weight: 700;
      letter-spacing: -0.3px;
      color: var(--text);
    }
    .brand-sub {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
    }

    .hBtn {
      display: flex;
      align-items: center;
      gap: 7px;
      padding: 9px 14px;
      border: 1px solid var(--border2);
      border-radius: 14px;
      background: var(--surface2);
      color: var(--text);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      font-family: inherit;
      transition: background 0.15s, border-color 0.15s, transform 0.1s;
    }
    .hBtn:active { transform: scale(0.97); }
    .hBtn:hover { background: rgba(255,255,255,0.10); }

    .cartBadge {
      background: var(--accent);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      min-width: 20px;
      height: 20px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0 5px;
    }
    .cartBadge.pulse { animation: pulse 0.4s ease; }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.4); }
      100% { transform: scale(1); }
    }

    /* â”€â”€ Search â”€â”€ */
    .searchWrap {
      padding: 8px 0 10px;
      max-width: 1200px;
      margin: auto;
    }
    .searchBox {
      display: flex;
      align-items: center;
      gap: 10px;
      background: var(--surface2);
      border: 1px solid var(--border2);
      border-radius: 14px;
      padding: 10px 14px;
      transition: border-color 0.2s;
    }
    .searchBox:focus-within {
      border-color: var(--accent);
    }
    .searchIcon { color: var(--muted); font-size: 16px; flex-shrink: 0; }
    .searchBox input {
      flex: 1;
      border: 0;
      outline: 0;
      background: transparent;
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
    }
    .searchBox input::placeholder { color: var(--muted); }
    .clearSearch {
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      font-size: 16px;
      padding: 0;
      display: none;
    }
    .clearSearch.show { display: block; }

    /* â”€â”€ Categories â”€â”€ */
    .catsToggle {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 0 10px;
    }
    .catsToggleBtn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 14px;
      border: 1px solid var(--border2);
      border-radius: 12px;
      background: var(--surface);
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.15s;
    }
    .catsToggleBtn.active {
      border-color: var(--accent);
      color: var(--text);
      background: rgba(124,109,250,0.12);
    }
    .catsToggleBtn .arrow {
      margin-right: auto;
      transition: transform 0.2s;
    }
    .catsToggleBtn.active .arrow { transform: rotate(180deg); }

    .catsPanel {
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.3s ease;
    }
    .catsPanel.open { max-height: 300px; }

    .catsRow {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      padding: 6px 0;
      scrollbar-width: none;
    }
    .catsRow::-webkit-scrollbar { display: none; }

    .catBtn {
      white-space: nowrap;
      padding: 8px 14px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: var(--surface);
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.15s;
    }
    .catBtn:hover { border-color: var(--border2); color: var(--text); }
    .catBtn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: #fff;
    }
    .subCatBtn {
      font-size: 12px;
      padding: 6px 12px;
    }
    .subCatBtn.active {
      background: rgba(124,109,250,0.25);
      border-color: rgba(124,109,250,0.5);
      color: #b8b0ff;
    }
    .brandBtn {
      font-size: 12px;
      padding: 5px 12px;
    }
    .brandBtn.active {
      background: rgba(245,200,66,0.15);
      border-color: rgba(245,200,66,0.4);
      color: var(--gold);
    }

    /* â”€â”€ Active Filters Bar â”€â”€ */
    .activeFilters {
      display: none;
      flex-wrap: wrap;
      gap: 6px;
      padding: 4px 0 8px;
    }
    .activeFilters.show { display: flex; }
    .filterTag {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 5px 10px;
      background: rgba(124,109,250,0.15);
      border: 1px solid rgba(124,109,250,0.3);
      border-radius: 999px;
      font-size: 12px;
      color: #b8b0ff;
    }
    .filterTag button {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      font-size: 13px;
      padding: 0;
      line-height: 1;
    }

    /* â”€â”€ Main â”€â”€ */
    .wrap {
      max-width: 1200px;
      margin: auto;
      padding: 14px 12px;
      position: relative;
      z-index: 1;
    }

    .secHead {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 6px 0 14px;
    }
    .secHead .h { font-size: 15px; font-weight: 700; }
    .secHead .sub { font-size: 12px; color: var(--muted); }

    /* â”€â”€ Grid â”€â”€ */
    .grid {
      display: grid;
      gap: 12px;
      grid-template-columns: repeat(4, 1fr);
    }
    @media (max-width: 960px) { .grid { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 680px) { .grid { grid-template-columns: repeat(2, 1fr); } }

    /* â”€â”€ Card â”€â”€ */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--r);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.18s, border-color 0.18s, box-shadow 0.18s;
      animation: fadeUp 0.3s ease both;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .card:hover {
      transform: translateY(-3px);
      border-color: var(--border2);
      box-shadow: 0 16px 40px rgba(0,0,0,0.35);
    }

    .cardImgWrap {
      position: relative;
      aspect-ratio: 1;
      overflow: hidden;
      background: var(--surface2);
      cursor: pointer;
    }
    .cardImg {
      width: 100%;
      height: 100%;
      object-fit: contain;
      padding: 12px;
      display: block;
      transition: transform 0.25s ease;
    }
    .card:hover .cardImg { transform: scale(1.04); }

    .discTag {
      position: absolute;
      top: 8px;
      right: 8px;
      background: var(--red);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      padding: 4px 8px;
      border-radius: 999px;
    }
    .offerTag {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(124,109,250,0.9);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      padding: 4px 8px;
      border-radius: 999px;
    }

    .cardBody {
      padding: 10px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .cardName {
      font-size: 13px;
      font-weight: 700;
      line-height: 1.35;
      cursor: pointer;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      min-height: 36px;
    }
    .cardName:hover { color: #b8b0ff; }
    .cardMeta {
      font-size: 11px;
      color: var(--muted);
      margin-top: 5px;
    }
    .priceRow {
      display: flex;
      align-items: baseline;
      gap: 7px;
      flex-wrap: wrap;
      margin-top: 8px;
    }
    .newPrice { font-size: 14px; font-weight: 700; color: #cfe0ff; }
    .oldPrice { font-size: 12px; color: var(--muted); text-decoration: line-through; }

    .btnRow {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 7px;
      margin-top: 10px;
    }
    .btn {
      padding: 9px 6px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--surface2);
      color: var(--text);
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.15s;
    }
    .btn:active { transform: scale(0.97); }
    .btn.add:hover { border-color: var(--accent); background: rgba(124,109,250,0.15); }
    .btn.order {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
      border-color: transparent;
      color: #fff;
    }
    .btn.order:hover { background: linear-gradient(135deg, #35d97a, #2ecc71); }

    /* â”€â”€ Skeleton â”€â”€ */
    .skeleton {
      background: var(--surface2);
      border-radius: var(--r);
      overflow: hidden;
      position: relative;
    }
    .skeleton::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, transparent 30%, rgba(255,255,255,0.05) 50%, transparent 70%);
      animation: shimmer 1.4s infinite;
    }
    @keyframes shimmer {
      from { transform: translateX(-100%); }
      to { transform: translateX(100%); }
    }
    .skImg { aspect-ratio: 1; background: var(--surface2); }
    .skLine { height: 12px; background: rgba(255,255,255,0.06); border-radius: 6px; margin: 8px 10px; }
    .skLine.short { width: 60%; }

    /* â”€â”€ Empty State â”€â”€ */
    .empty {
      grid-column: 1 / -1;
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }
    .empty .icon { font-size: 48px; margin-bottom: 14px; }
    .empty .msg { font-size: 15px; font-weight: 600; color: var(--text); }
    .empty .sub { font-size: 13px; margin-top: 6px; }

    /* â”€â”€ Cart Bar â”€â”€ */
    .cartBar {
      position: fixed;
      left: calc(12px + var(--safe-left));
      right: calc(12px + var(--safe-right));
      bottom: calc(12px + var(--safe-bottom));
      z-index: 60;
      background: rgba(10,10,20,0.90);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--border2);
      border-radius: var(--r2);
      box-shadow: 0 20px 50px rgba(0,0,0,0.50);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 14px;
      cursor: pointer;
      transition: transform 0.2s, opacity 0.2s;
    }
    .cartBar:hover { transform: translateY(-2px); }
    .cartBar:active { transform: scale(0.99); }
    .cartBar.empty { opacity: 0.5; }

    .cartBarInfo .label { font-size: 11px; color: var(--muted); }
    .cartBarInfo .amount { font-size: 16px; font-weight: 700; }

    .cartBarBtn {
      display: flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: #fff;
      border: none;
      border-radius: 14px;
      padding: 11px 16px;
      font-size: 13px;
      font-weight: 700;
      font-family: inherit;
      pointer-events: none;
    }
    .cartBarCount {
      background: rgba(255,255,255,0.2);
      border-radius: 999px;
      min-width: 22px;
      height: 22px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      padding: 0 6px;
    }

    /* â”€â”€ Overlay â”€â”€ */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.60);
      display: none;
      z-index: 90;
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }
    .overlay.show { display: block; animation: fadeIn 0.2s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* â”€â”€ Drawer â”€â”€ */
    .drawer {
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: min(460px, 96vw);
      background: #0a0a14;
      border-right: 1px solid var(--border);
      transform: translateX(-110%);
      transition: transform 0.25s cubic-bezier(0.4,0,0.2,1);
      z-index: 100;
      display: flex;
      flex-direction: column;
      padding-top: var(--safe-top);
    }
    .drawer.open { transform: translateX(0); }

    #prodDrawer {
      left: auto;
      right: 0;
      border-right: 0;
      border-left: 1px solid var(--border);
      transform: translateX(110%);
    }
    #prodDrawer.open { transform: translateX(0); }

    .dHead {
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      flex-shrink: 0;
    }
    .dHead .title { font-size: 15px; font-weight: 700; }

    .closeBtn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 34px;
      height: 34px;
      border: 1px solid var(--border2);
      border-radius: 10px;
      background: var(--surface2);
      color: var(--text);
      font-size: 16px;
      cursor: pointer;
      font-family: inherit;
      transition: background 0.15s;
    }
    .closeBtn:hover { background: rgba(255,255,255,0.12); }

    .dBody {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      scrollbar-width: thin;
      scrollbar-color: var(--border2) transparent;
    }

    .dFoot {
      padding: 14px 16px;
      border-top: 1px solid var(--border);
      background: rgba(255,255,255,0.02);
      flex-shrink: 0;
    }

    /* â”€â”€ Cart Items â”€â”€ */
    .cartItem {
      display: flex;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid var(--border);
      align-items: flex-start;
      animation: fadeUp 0.2s ease both;
    }
    .cartThumb {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      object-fit: contain;
      background: var(--surface2);
      border: 1px solid var(--border);
      flex-shrink: 0;
      padding: 4px;
    }
    .cartInfo { flex: 1; min-width: 0; }
    .cartName { font-size: 13px; font-weight: 700; }
    .cartPrice { font-size: 12px; color: var(--muted); margin-top: 4px; }
    .qtyRow {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 8px;
    }
    .qBtn {
      width: 30px;
      height: 30px;
      border-radius: 10px;
      border: 1px solid var(--border2);
      background: var(--surface2);
      color: var(--text);
      font-size: 16px;
      cursor: pointer;
      font-family: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s;
    }
    .qBtn:hover { background: rgba(255,255,255,0.12); }
    .qNum { font-size: 14px; font-weight: 700; min-width: 20px; text-align: center; }
    .rmBtn {
      margin-right: auto;
      width: 30px;
      height: 30px;
      border-radius: 10px;
      border: 1px solid rgba(231,76,60,0.25);
      background: rgba(231,76,60,0.08);
      color: #ff8080;
      cursor: pointer;
      font-family: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: background 0.15s;
    }
    .rmBtn:hover { background: rgba(231,76,60,0.18); }

    /* â”€â”€ Order Form â”€â”€ */
    .formGrid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 14px;
    }
    .formField {
      position: relative;
    }
    .formField.full { grid-column: 1 / -1; }
    .formLabel {
      font-size: 11px;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 5px;
      display: block;
    }
    .formField input, .formField textarea {
      width: 100%;
      padding: 10px 12px;
      background: var(--surface2);
      border: 1px solid var(--border2);
      border-radius: 12px;
      color: var(--text);
      font-size: 14px;
      font-family: inherit;
      outline: none;
      transition: border-color 0.2s;
    }
    .formField input:focus, .formField textarea:focus {
      border-color: var(--accent);
    }
    .formField input::placeholder, .formField textarea::placeholder {
      color: var(--muted);
    }

    /* â”€â”€ Summary â”€â”€ */
    .summaryBox {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px 14px;
      margin-bottom: 12px;
    }
    .sumLine {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 13px;
      color: var(--muted);
      padding: 4px 0;
    }
    .sumLine.total {
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
      border-top: 1px solid var(--border);
      margin-top: 6px;
      padding-top: 10px;
    }
    .saveBadge {
      background: rgba(46,204,113,0.15);
      border: 1px solid rgba(46,204,113,0.3);
      color: var(--green);
      font-size: 11px;
      font-weight: 700;
      padding: 3px 8px;
      border-radius: 999px;
    }

    .sendBtn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #25D366, #128C7E);
      color: #fff;
      border: none;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: opacity 0.15s, transform 0.15s;
    }
    .sendBtn:hover { opacity: 0.92; }
    .sendBtn:active { transform: scale(0.99); }

    .clearBtn {
      width: 100%;
      padding: 12px;
      background: transparent;
      color: #ff8080;
      border: 1px solid rgba(231,76,60,0.25);
      border-radius: 14px;
      font-size: 13px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      margin-top: 8px;
      transition: background 0.15s;
    }
    .clearBtn:hover { background: rgba(231,76,60,0.08); }

    /* â”€â”€ Product Drawer â”€â”€ */
    .prodImg {
      width: 100%;
      aspect-ratio: 1;
      object-fit: contain;
      background: var(--surface2);
      border-radius: 18px;
      border: 1px solid var(--border);
      padding: 20px;
    }
    .prodDesc {
      font-size: 14px;
      line-height: 1.8;
      color: rgba(240,240,255,0.80);
      margin-top: 12px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* â”€â”€ Toast â”€â”€ */
    .toast {
      position: fixed;
      bottom: calc(90px + var(--safe-bottom) + 12px);
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: rgba(124,109,250,0.95);
      color: #fff;
      padding: 10px 18px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 700;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 200;
      white-space: nowrap;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* â”€â”€ Confirm Dialog â”€â”€ */
    .confirm {
      position: fixed;
      inset: 0;
      z-index: 150;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .confirm.show { display: flex; }
    .confirmBox {
      background: #12121e;
      border: 1px solid var(--border2);
      border-radius: var(--r2);
      padding: 24px;
      max-width: 320px;
      width: 100%;
      text-align: center;
      box-shadow: 0 30px 70px rgba(0,0,0,0.5);
      animation: scaleIn 0.2s ease;
    }
    @keyframes scaleIn {
      from { transform: scale(0.92); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .confirmBox .icon { font-size: 40px; margin-bottom: 12px; }
    .confirmBox .msg { font-size: 16px; font-weight: 700; margin-bottom: 6px; }
    .confirmBox .sub { font-size: 13px; color: var(--muted); margin-bottom: 20px; }
    .confirmBtns { display: flex; gap: 10px; }
    .confirmBtns button {
      flex: 1;
      padding: 12px;
      border-radius: 14px;
      font-size: 14px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      border: 1px solid var(--border2);
      background: var(--surface2);
      color: var(--text);
      transition: background 0.15s;
    }
    .confirmBtns .danger {
      background: rgba(231,76,60,0.15);
      border-color: rgba(231,76,60,0.3);
      color: #ff8080;
    }
    .confirmBtns .danger:hover { background: rgba(231,76,60,0.25); }

    /* â”€â”€ Scroll to top â”€â”€ */
    .scrollTop {
      position: fixed;
      left: calc(14px + var(--safe-left));
      bottom: calc(90px + var(--safe-bottom) + 14px);
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: var(--surface2);
      border: 1px solid var(--border2);
      color: var(--text);
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 55;
    }
    .scrollTop.show { opacity: 1; pointer-events: all; }
    .scrollTop:hover { transform: translateY(-2px); }

    input, textarea, select, button { font-size: 16px !important; }
    html { -webkit-text-size-adjust: 100%; }
  </style>

</head>
<body>

<!-- â”€â”€ Header â”€â”€ -->

<header>
  <div class="bar">
    <button class="hBtn" onclick="openCart()">
      ğŸ›’ Ø§Ù„Ø³Ù„Ø©
      <span class="cartBadge" id="cartCount">0</span>
    </button>

```
<div class="brand">
  <div class="brand-name">Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙØ±Ø¯ÙˆØ³</div>
  <div class="brand-sub">Ù„Ù„Ù‡ÙˆØ§ØªÙ ÙˆØ§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</div>
</div>

<button class="hBtn" onclick="scrollToShop()">ğŸ›ï¸ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
```

  </div>

  <div class="searchWrap">
    <div class="searchBox">
      <span class="searchIcon">ğŸ”</span>
      <input id="q" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬ØŒ Ù…Ø§Ø±ÙƒØ©ØŒ Ù†ÙˆØ¹..." />
      <button class="clearSearch" id="clearSearchBtn" onclick="clearSearch()">âœ•</button>
    </div>
  </div>

  <div class="catsToggle">
    <button class="catsToggleBtn" id="catsToggleBtn" onclick="toggleCats()">
      ğŸ“‚ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„ÙÙ„Ø§ØªØ±
      <span class="arrow">â–¾</span>
    </button>
  </div>

  <div class="catsPanel" id="catsPanel">
    <div class="catsRow" id="catsBar"></div>
    <div class="catsRow" id="subCatsBar" style="display:none"></div>
    <div class="catsRow" id="brandsBar" style="display:none"></div>
  </div>
</header>

<!-- â”€â”€ Main â”€â”€ -->

<div class="wrap">
  <div class="secHead" id="shopTop">
    <div class="h">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
    <div class="sub" id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>
  <div class="activeFilters" id="activeFilters"></div>
  <div id="grid" class="grid"></div>
</div>

<!-- â”€â”€ Cart Bar â”€â”€ -->

<div class="cartBar" id="cartBar" onclick="openCart()">
  <div class="cartBarInfo">
    <div class="label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ø©</div>
    <div class="amount" id="cartSum">0 Ø¯.Ø¹</div>
  </div>
  <div class="cartBarBtn">
    ÙØªØ­ Ø§Ù„Ø³Ù„Ø©
    <span class="cartBarCount" id="cartQty">0</span>
  </div>
</div>

<!-- â”€â”€ Scroll Top â”€â”€ -->

<button class="scrollTop" id="scrollTop" onclick="window.scrollTo({top:0,behavior:'smooth'})">â†‘</button>

<!-- â”€â”€ Overlay â”€â”€ -->

<div class="overlay" id="overlay" onclick="closeAll()"></div>

<!-- â”€â”€ Cart Drawer â”€â”€ -->

<div class="drawer" id="cartDrawer">
  <div class="dHead">
    <div class="title">ğŸ›’ Ø§Ù„Ø³Ù„Ø© ÙˆØ¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</div>
    <button class="closeBtn" onclick="closeAll()">âœ•</button>
  </div>
  <div class="dBody" id="cartBody"></div>
  <div class="dFoot">
    <div class="summaryBox">
      <div class="sumLine"><span>Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…</span><span id="sumOld">0 Ø¯.Ø¹</span></div>
      <div class="sumLine"><span>Ø§Ù„ØªÙˆÙÙŠØ±</span><span class="saveBadge" id="sumSave">0 Ø¯.Ø¹</span></div>
      <div class="sumLine total"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span id="sumNew">0 Ø¯.Ø¹</span></div>
    </div>

```
<div class="formGrid">
  <div class="formField">
    <label class="formLabel">Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ† *</label>
    <input id="name" placeholder="Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ..." />
  </div>
  <div class="formField">
    <label class="formLabel">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ *</label>
    <input id="phone" type="tel" placeholder="07XXXXXXXXX" />
  </div>
  <div class="formField full">
    <label class="formLabel">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„ + Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© *</label>
    <input id="address" placeholder="Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© / Ø§Ù„Ù…Ù†Ø·Ù‚Ø© / Ø§Ù„Ø´Ø§Ø±Ø¹..." />
  </div>
  <div class="formField full">
    <label class="formLabel">Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
    <textarea id="note" rows="2" placeholder="Ø£ÙŠ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©..."></textarea>
  </div>
</div>

<button class="sendBtn" onclick="sendWhatsApp()">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
  Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨
</button>
<button class="clearBtn" onclick="confirmClear()">ğŸ—‘ ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©</button>
```

  </div>
</div>

<!-- â”€â”€ Product Drawer â”€â”€ -->

<div class="drawer" id="prodDrawer">
  <div class="dHead">
    <div class="title" id="pTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</div>
    <button class="closeBtn" onclick="closeAll()">âœ•</button>
  </div>
  <div class="dBody" id="pBody"></div>
</div>

<!-- â”€â”€ Toast â”€â”€ -->

<div class="toast" id="toast"></div>

<!-- â”€â”€ Confirm Dialog â”€â”€ -->

<div class="confirm" id="confirmDialog">
  <div class="confirmBox">
    <div class="icon">ğŸ—‘</div>
    <div class="msg">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©ØŸ</div>
    <div class="sub">Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„Ø³Ù„Ø©. Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.</div>
    <div class="confirmBtns">
      <button onclick="closeConfirm()">Ø¥Ù„ØºØ§Ø¡</button>
      <button class="danger" onclick="doClear()">ØªÙØ±ÙŠØº</button>
    </div>
  </div>
</div>

<script>
  const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vToXcV323xvYtiuz6tg-d0q_f2iwOwnYBpCRqAgSnarQ2PYVZ9Z1GJKlSmftjuajtlJ6zBfmVbRwArp/pub?output=csv";
  const WHATSAPP_NUMBER = "9647719183122";

  const $ = id => document.getElementById(id);

  const state = {
    products: [],
    cats: [],
    activeCat: "",
    activeSub: "",
    activeBrand: "",
    cart: loadCart(),
    catsOpen: false
  };

  function loadCart() {
    try { return JSON.parse(localStorage.getItem("cart") || "{}"); }
    catch(e) { return {}; }
  }
  function saveCart() {
    localStorage.setItem("cart", JSON.stringify(state.cart));
    updateCartUI();
  }

  // â”€â”€ CSV Parser â”€â”€
  function parseCSV(text) {
    const rows = [];
    let row = [], cur = "", inQ = false;
    for (let i = 0; i < text.length; i++) {
      const ch = text[i], next = text[i+1];
      if (ch === '"') {
        if (inQ && next === '"') { cur += '"'; i++; }
        else inQ = !inQ;
        continue;
      }
      if (ch === "," && !inQ) { row.push(cur); cur = ""; continue; }
      if ((ch === "\n" || ch === "\r") && !inQ) {
        if (ch === "\r" && next === "\n") i++;
        row.push(cur); cur = "";
        if (row.some(v => String(v).trim())) rows.push(row);
        row = [];
        continue;
      }
      cur += ch;
    }
    row.push(cur);
    if (row.some(v => String(v).trim())) rows.push(row);
    const headers = rows.shift().map(h => String(h||"").trim());
    return rows.map(cols => {
      const obj = {};
      headers.forEach((h,i) => obj[h] = (cols[i] ?? "").toString());
      return obj;
    });
  }

  function money(n) { return (Number(n)||0).toLocaleString("ar-IQ"); }
  function pct(o, n) {
    o=Number(o||0); n=Number(n||0);
    if(!o || o<=n) return 0;
    return Math.round(((o-n)/o)*100);
  }
  function esc(s) {
    return String(s||"").replace(/[&<>"']/g, m=>
      ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[m])
    );
  }

  // â”€â”€ Toast â”€â”€
  let toastTimer;
  function showToast(msg) {
    const t = $("toast");
    t.textContent = msg;
    t.classList.add("show");
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => t.classList.remove("show"), 1800);
  }

  // â”€â”€ Load â”€â”€
  async function load() {
    showSkeletons();
    try {
      const res = await fetch(SHEET_CSV_URL);
      const text = await res.text();
      const rows = parseCSV(text);

      state.products = rows.map((r,idx) => ({
        _i: idx,
        id: String(r.id||"").trim(),
        name: (r.name||"").trim(),
        price: Number(r.price||0),
        old_price: Number(r.old_price||0),
        offer: String(r.offer||"").toLowerCase().trim() === "yes",
        discount_note: (r.discount_note||"").trim(),
        image: (r.image||"").trim(),
        category: (r.category||"ØºÙŠØ± Ù…ØµÙ†Ù").trim(),
        sub_category: (r.sub_category||"").trim(),
        brand: (r.brand||"").trim(),
        desc: (r.desc||"").toString().trim()
      })).filter(p => p.id && p.name && p.price);

      state.cats = [...new Set(state.products.map(p => p.category))].sort((a,b) => a.localeCompare(b,"ar"));
      if (state.cats.includes("Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©"))
        state.cats = ["Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©", ...state.cats.filter(c => c !== "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©")];

      $("status").textContent = `${state.products.length} Ù…Ù†ØªØ¬`;
      renderCatsBar();
      renderProducts();
      updateCartUI();
    } catch(e) {
      $("grid").innerHTML = `<div class="empty"><div class="icon">âš ï¸</div><div class="msg">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div><div class="sub">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</div></div>`;
      $("status").textContent = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„";
    }
  }

  function showSkeletons() {
    const g = $("grid");
    g.innerHTML = Array(8).fill(`
      <div class="skeleton">
        <div class="skeleton skImg"></div>
        <div class="skLine"></div>
        <div class="skLine short"></div>
      </div>
    `).join("");
  }

  // â”€â”€ Toggle Cats â”€â”€
  function toggleCats() {
    state.catsOpen = !state.catsOpen;
    const panel = $("catsPanel");
    const btn = $("catsToggleBtn");
    if (state.catsOpen) {
      panel.classList.add("open");
      btn.classList.add("active");
      renderSubCatsBar();
      renderBrandsBar();
    } else {
      panel.classList.remove("open");
      btn.classList.remove("active");
    }
  }

  function setActive(container, btn) {
    [...container.children].forEach(x => x.classList.remove("active"));
    btn.classList.add("active");
  }

  function renderCatsBar() {
    const bar = $("catsBar");
    bar.innerHTML = "";
    const all = mkBtn("catBtn" + (!state.activeCat?" active":""), "Ø§Ù„ÙƒÙ„", () => {
      state.activeCat = state.activeSub = state.activeBrand = "";
      setActive(bar, all);
      renderSubCatsBar(); renderBrandsBar(); renderProducts(); updateFiltersBar();
    });
    bar.appendChild(all);
    state.cats.forEach(cat => {
      const b = mkBtn("catBtn" + (state.activeCat===cat?" active":""), cat, () => {
        state.activeCat = cat; state.activeSub = state.activeBrand = "";
        setActive(bar, b);
        renderSubCatsBar(); renderBrandsBar(); renderProducts(); scrollToShop(); updateFiltersBar();
      });
      bar.appendChild(b);
    });
  }

  function renderSubCatsBar() {
    const bar = $("subCatsBar");
    if (state.activeCat !== "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©" || !state.catsOpen) {
      bar.style.display = "none"; state.activeSub = ""; return;
    }
    const subs = [...new Set(state.products.filter(p=>p.category==="Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©").map(p=>p.sub_category).filter(Boolean))].sort((a,b)=>a.localeCompare(b,"ar"));
    if (!subs.length) { bar.style.display = "none"; state.activeSub = ""; return; }
    bar.style.display = "flex"; bar.innerHTML = "";
    const all = mkBtn("catBtn subCatBtn" + (!state.activeSub?" active":""), "ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹", () => {
      state.activeSub = ""; setActive(bar, all); renderBrandsBar(); renderProducts(); updateFiltersBar();
    });
    bar.appendChild(all);
    subs.forEach(s => {
      const b = mkBtn("catBtn subCatBtn" + (state.activeSub===s?" active":""), s, () => {
        state.activeSub = s; state.activeBrand = ""; setActive(bar, b); renderBrandsBar(); renderProducts(); updateFiltersBar();
      });
      bar.appendChild(b);
    });
  }

  function renderBrandsBar() {
    const bar = $("brandsBar");
    if (state.activeCat !== "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©" || !state.catsOpen) {
      bar.style.display = "none"; state.activeBrand = ""; return;
    }
    const brands = [...new Set(state.products.filter(p=>p.category==="Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©").filter(p=>!state.activeSub||p.sub_category===state.activeSub).map(p=>p.brand).filter(Boolean))].sort((a,b)=>a.localeCompare(b,"en"));
    if (!brands.length) { bar.style.display = "none"; state.activeBrand = ""; return; }
    bar.style.display = "flex"; bar.innerHTML = "";
    const all = mkBtn("catBtn brandBtn" + (!state.activeBrand?" active":""), "ÙƒÙ„ Ø§Ù„Ø´Ø±ÙƒØ§Øª", () => {
      state.activeBrand = ""; setActive(bar, all); renderProducts(); updateFiltersBar();
    });
    bar.appendChild(all);
    brands.forEach(b => {
      const btn = mkBtn("catBtn brandBtn" + (state.activeBrand===b?" active":""), b, () => {
        state.activeBrand = b; setActive(bar, btn); renderProducts(); updateFiltersBar();
      });
      bar.appendChild(btn);
    });
  }

  function mkBtn(cls, text, onClick) {
    const b = document.createElement("button");
    b.className = cls; b.textContent = text; b.onclick = onClick;
    return b;
  }

  function updateFiltersBar() {
    const bar = $("activeFilters");
    bar.innerHTML = "";
    const tags = [];
    if (state.activeCat) tags.push({ label: state.activeCat, clear: () => { state.activeCat = state.activeSub = state.activeBrand = ""; renderCatsBar(); renderSubCatsBar(); renderBrandsBar(); renderProducts(); updateFiltersBar(); }});
    if (state.activeSub) tags.push({ label: state.activeSub, clear: () => { state.activeSub = ""; renderSubCatsBar(); renderBrandsBar(); renderProducts(); updateFiltersBar(); }});
    if (state.activeBrand) tags.push({ label: state.activeBrand, clear: () => { state.activeBrand = ""; renderBrandsBar(); renderProducts(); updateFiltersBar(); }});
    if (!tags.length) { bar.classList.remove("show"); return; }
    bar.classList.add("show");
    tags.forEach(t => {
      const el = document.createElement("div");
      el.className = "filterTag";
      el.innerHTML = `${esc(t.label)} <button onclick="">âœ•</button>`;
      el.querySelector("button").onclick = () => { t.clear(); };
      bar.appendChild(el);
    });
  }

  function baseFilter() {
    const q = ($("q").value||"").toLowerCase().trim();
    return state.products.filter(p => {
      const okC = !state.activeCat || p.category === state.activeCat;
      const okS = state.activeCat !== "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©" || !state.activeSub || p.sub_category === state.activeSub;
      const okB = state.activeCat !== "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©" || !state.activeBrand || p.brand === state.activeBrand;
      const okQ = !q || p.name.toLowerCase().includes(q) || (p.desc||"").toLowerCase().includes(q) || (p.brand||"").toLowerCase().includes(q);
      return okC && okS && okB && okQ;
    });
  }

  function renderProducts() {
    const list = baseFilter().sort((a,b) => a._i - b._i);
    const grid = $("grid");
    grid.innerHTML = "";

    if (!list.length) {
      grid.innerHTML = `<div class="empty"><div class="icon">ğŸ”</div><div class="msg">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</div><div class="sub">Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„ÙÙ„ØªØ± Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø« Ø¨ÙƒÙ„Ù…Ø© Ù…Ø®ØªÙ„ÙØ©</div></div>`;
      $("status").textContent = "0 Ù…Ù†ØªØ¬Ø§Øª";
      return;
    }

    $("status").textContent = `${list.length} Ù…Ù†ØªØ¬`;

    list.forEach((p, idx) => {
      const hasDisc = p.old_price && p.old_price > p.price;
      const disc = hasDisc ? pct(p.old_price, p.price) : 0;
      let meta = p.category;
      if (p.category === "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©") {
        const parts = [p.sub_category, p.brand].filter(Boolean);
        if (parts.length) meta = parts.join(" â€¢ ");
      }

      const card = document.createElement("div");
      card.className = "card";
      card.style.animationDelay = `${Math.min(idx, 12) * 30}ms`;
      card.innerHTML = `
        <div class="cardImgWrap" onclick="openProduct('${p.id}')">
          ${hasDisc ? `<div class="discTag">-${disc}%</div>` : ""}
          ${p.offer ? `<div class="offerTag">${esc(p.discount_note || "Ø¹Ø±Ø¶ Ø®Ø§Øµ")}</div>` : ""}
          <img class="cardImg" src="${esc(p.image)}" alt="${esc(p.name)}" loading="lazy" decoding="async" onerror="this.style.opacity='0'">
        </div>
        <div class="cardBody">
          <div class="cardName" onclick="openProduct('${p.id}')">${esc(p.name)}</div>
          <div class="cardMeta">${esc(meta)}</div>
          <div class="priceRow">
            <div class="newPrice">${money(p.price)} Ø¯.Ø¹</div>
            ${hasDisc ? `<div class="oldPrice">${money(p.old_price)} Ø¯.Ø¹</div>` : ""}
          </div>
          <div class="btnRow">
            <button class="btn add" onclick="addToCart('${p.id}')">+ Ø§Ù„Ø³Ù„Ø©</button>
            <button class="btn order" onclick="orderNow('${p.id}')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
          </div>
        </div>
      `;
      grid.appendChild(card);
    });
  }

  // â”€â”€ Product Details â”€â”€
  function openProduct(id) {
    const p = state.products.find(x => x.id === id);
    if (!p) return;
    const hasDisc = p.old_price && p.old_price > p.price;
    const disc = hasDisc ? pct(p.old_price, p.price) : 0;
    let info = p.category;
    if (p.category === "Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©") {
      const parts = [p.sub_category, p.brand].filter(Boolean);
      if (parts.length) info = parts.join(" â€¢ ");
    }
    $("pTitle").textContent = p.name;
    $("pBody").innerHTML = `
      <img class="prodImg" src="${esc(p.image)}" loading="lazy" onerror="this.style.opacity='0'">
      <div style="margin-top:14px; font-size:17px; font-weight:700;">${esc(p.name)}</div>
      <div style="color:var(--muted); font-size:13px; margin-top:5px">${esc(info)}</div>
      <div style="display:flex; align-items:baseline; gap:10px; margin-top:12px; flex-wrap:wrap;">
        <div style="font-size:20px; font-weight:700; color:#cfe0ff">${money(p.price)} Ø¯.Ø¹</div>
        ${hasDisc ? `<div style="font-size:14px; text-decoration:line-through; color:var(--muted)">${money(p.old_price)} Ø¯.Ø¹</div>` : ""}
        ${hasDisc ? `<span style="background:rgba(231,76,60,0.2); border:1px solid rgba(231,76,60,0.4); color:#ff9090; padding:3px 10px; border-radius:999px; font-size:12px; font-weight:700">Ø®ØµÙ… ${disc}%</span>` : ""}
      </div>
      ${p.desc ? `<div class="prodDesc">${esc(p.desc)}</div>` : ""}
      <div class="btnRow" style="margin-top:16px">
        <button class="btn add" onclick="addToCart('${p.id}'); showToast('âœ“ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©')">+ Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
        <button class="btn order" onclick="orderNow('${p.id}')">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
      </div>
    `;
    showOverlay(true);
    $("prodDrawer").classList.add("open");
  }

  // â”€â”€ Cart â”€â”€
  function addToCart(id) {
    state.cart[id] = (state.cart[id]||0) + 1;
    saveCart();
    showToast("âœ“ ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬");
    const badge = $("cartCount");
    badge.classList.remove("pulse");
    void badge.offsetWidth;
    badge.classList.add("pulse");
  }
  function orderNow(id) { addToCart(id); closeAll(); openCart(); }

  function cartItems() {
    return Object.entries(state.cart).map(([id,qty]) => {
      const p = state.products.find(x => x.id === id);
      if (!p) return null;
      const old = p.old_price && p.old_price > 0 ? p.old_price : p.price;
      return { ...p, qty, lineNew: p.price*qty, lineOld: old*qty };
    }).filter(Boolean);
  }

  function updateCartUI() {
    const qty = Object.values(state.cart).reduce((a,b) => a+b, 0);
    $("cartCount").textContent = qty;
    $("cartQty").textContent = qty;
    const items = cartItems();
    const sumNew = items.reduce((a,b) => a+b.lineNew, 0);
    $("cartSum").textContent = `${money(sumNew)} Ø¯.Ø¹`;
    $("cartBar").classList.toggle("empty", qty === 0);
  }

  function openCart() { renderCart(); showOverlay(true); $("cartDrawer").classList.add("open"); }

  function renderCart() {
    const items = cartItems();
    const body = $("cartBody");
    body.innerHTML = items.length
      ? items.map(it => `
          <div class="cartItem">
            <img class="cartThumb" src="${esc(it.image)}" loading="lazy" onerror="this.style.opacity='0'">
            <div class="cartInfo">
              <div class="cartName">${esc(it.name)}</div>
              <div class="cartPrice">${money(it.price)} Ø¯.Ø¹ Ã— ${it.qty} = <b>${money(it.lineNew)} Ø¯.Ø¹</b></div>
              <div class="qtyRow">
                <button class="qBtn" onclick="dec('${it.id}')">âˆ’</button>
                <span class="qNum">${it.qty}</span>
                <button class="qBtn" onclick="inc('${it.id}')">+</button>
                <button class="rmBtn" onclick="removeItem('${it.id}')">âœ•</button>
              </div>
            </div>
          </div>
        `).join("")
      : `<div class="empty" style="padding:40px 20px"><div class="icon">ğŸ›’</div><div class="msg">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div><div class="sub">Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ø¨Ø¯Ø¡ Ø¨Ø§Ù„Ø·Ù„Ø¨</div></div>`;

    const sumNew = items.reduce((a,b)=>a+b.lineNew,0);
    const sumOld = items.reduce((a,b)=>a+b.lineOld,0);
    const save = Math.max(0, sumOld-sumNew);
    $("sumNew").textContent = `${money(sumNew)} Ø¯.Ø¹`;
    $("sumOld").textContent = `${money(sumOld)} Ø¯.Ø¹`;
    $("sumSave").textContent = `${money(save)} Ø¯.Ø¹`;
  }

  function inc(id) { state.cart[id]=(state.cart[id]||0)+1; saveCart(); renderCart(); }
  function dec(id) {
    if (!state.cart[id]) return;
    state.cart[id]--;
    if (state.cart[id] <= 0) delete state.cart[id];
    saveCart(); renderCart();
  }
  function removeItem(id) { delete state.cart[id]; saveCart(); renderCart(); }

  function confirmClear() { $("confirmDialog").classList.add("show"); }
  function closeConfirm() { $("confirmDialog").classList.remove("show"); }
  function doClear() { state.cart={}; saveCart(); renderCart(); closeConfirm(); showToast("ğŸ—‘ ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©"); }

  // â”€â”€ WhatsApp â”€â”€
  function sendWhatsApp() {
    const items = cartItems();
    if (!items.length) { showToast("âš ï¸ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©"); return; }
    const name = $("name").value.trim();
    const phone = $("phone").value.trim();
    const address = $("address").value.trim();
    const note = $("note").value.trim();
    if (!name || !phone || !address) { showToast("âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©"); return; }
    const sumNew = items.reduce((a,b)=>a+b.lineNew,0);
    const sumOld = items.reduce((a,b)=>a+b.lineOld,0);
    const save = Math.max(0, sumOld-sumNew);
    let msg = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙØ±Ø¯ÙˆØ³%0A%0A`;
    msg += `Ø§Ù„Ø§Ø³Ù…: ${encodeURIComponent(name)}%0A`;
    msg += `Ø§Ù„Ù‡Ø§ØªÙ: ${encodeURIComponent(phone)}%0A`;
    msg += `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${encodeURIComponent(address)}%0A`;
    if (note) msg += `Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${encodeURIComponent(note)}%0A`;
    msg += `%0AØ§Ù„Ù…Ù†ØªØ¬Ø§Øª:%0A`;
    items.forEach((it,i) => msg += `${encodeURIComponent(`${i+1}) ${it.name} | Ø¹Ø¯Ø¯: ${it.qty} | Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${it.lineNew} Ø¯.Ø¹`)}%0A`);
    msg += `%0AÙ‚Ø¨Ù„ Ø§Ù„Ø®ØµÙ…: ${sumOld}%0A`;
    msg += `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${sumNew}%0A`;
    if (save > 0) msg += `Ø§Ù„ØªÙˆÙÙŠØ±: ${save}%0A`;
    window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`, "_blank");
  }

  function showOverlay(on) {
    const o = $("overlay");
    if (on) o.classList.add("show"); else o.classList.remove("show");
  }
  function closeAll() {
    showOverlay(false);
    $("cartDrawer").classList.remove("open");
    $("prodDrawer").classList.remove("open");
    closeConfirm();
  }
  function scrollToShop() { $("shopTop").scrollIntoView({ behavior: "smooth" }); }

  // â”€â”€ Search â”€â”€
  function clearSearch() {
    $("q").value = "";
    $("clearSearchBtn").classList.remove("show");
    renderProducts();
  }
  $("q").addEventListener("input", function() {
    $("clearSearchBtn").classList.toggle("show", this.value.length > 0);
    renderProducts();
  });

  // â”€â”€ Scroll Top â”€â”€
  window.addEventListener("scroll", () => {
    $("scrollTop").classList.toggle("show", window.scrollY > 400);
  });

  load();
</script>

</body>
</html>